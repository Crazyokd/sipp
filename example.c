#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include "sipp.h"

static int just_print_header(str_t *field, str_t *value, headers_t *headers)
{
    (void)headers;
    printf("field: %.*s; value: %.*s\n", field->len, field->start, value->len,
           value->start);
    return 0;
}

static int assign_content_length(str_t *field, str_t *value, headers_t *headers)
{
    printf("field: %.*s; value: %.*s\n", field->len, field->start, value->len,
           value->start);
    headers->content_length = atoi(value->start);

    return 0;
}

int main()
{
    unsigned char hdr[] = {
        /* response part */
        // 0x53, 0x49, 0x50, 0x2f, 0x32, 0x2e, 0x30, 0x20, 0x32, 0x30, 0x32, 0x20,
        // 0x41, 0x63, 0x63, 0x65, 0x70, 0x74, 0x65, 0x64, 0x0d, 0x0a,
        /* request part */
        0x4d,
        0x45,
        0x53,
        0x53,
        0x41,
        0x47,
        0x45,
        0x20,
        0x73,
        0x69,
        0x70,
        0x3a,
        0x31,
        0x33,
        0x38,
        0x30,
        0x31,
        0x32,
        0x33,
        0x34,
        0x35,
        0x30,
        0x33,
        0x40,
        0x69,
        0x6d,
        0x73,
        0x2e,
        0x6d,
        0x6e,
        0x63,
        0x30,
        0x30,
        0x30,
        0x2e,
        0x6d,
        0x63,
        0x63,
        0x34,
        0x36,
        0x30,
        0x2e,
        0x33,
        0x67,
        0x70,
        0x70,
        0x6e,
        0x65,
        0x74,
        0x77,
        0x6f,
        0x72,
        0x6b,
        0x2e,
        0x6f,
        0x72,
        0x67,
        0x20,
        0x53,
        0x49,
        0x50,
        0x2f,
        0x32,
        0x2e,
        0x30,
        0x0d,
        0x0a,
        /* header part */
        0x54,
        0x6f,
        0x3a,
        0x20,
        0x3c,
        0x73,
        0x69,
        0x70,
        0x3a,
        0x34,
        0x36,
        0x30,
        0x30,
        0x30,
        0x38,
        0x37,
        0x36,
        0x35,
        0x34,
        0x33,
        0x32,
        0x31,
        0x30,
        0x31,
        0x40,
        0x69,
        0x6d,
        0x73,
        0x2e,
        0x6d,
        0x6e,
        0x63,
        0x30,
        0x30,
        0x30,
        0x2e,
        0x6d,
        0x63,
        0x63,
        0x34,
        0x36,
        0x30,
        0x2e,
        0x33,
        0x67,
        0x70,
        0x70,
        0x6e,
        0x65,
        0x74,
        0x77,
        0x6f,
        0x72,
        0x6b,
        0x2e,
        0x6f,
        0x72,
        0x67,
        0x3e,
        0x0d,
        0x0a,
        0x46,
        0x72,
        0x6f,
        0x6d,
        0x3a,
        0x20,
        0x3c,
        0x73,
        0x69,
        0x70,
        0x3a,
        0x34,
        0x36,
        0x30,
        0x30,
        0x30,
        0x38,
        0x37,
        0x36,
        0x35,
        0x34,
        0x33,
        0x32,
        0x31,
        0x30,
        0x31,
        0x40,
        0x69,
        0x6d,
        0x73,
        0x2e,
        0x6d,
        0x6e,
        0x63,
        0x30,
        0x30,
        0x30,
        0x2e,
        0x6d,
        0x63,
        0x63,
        0x34,
        0x36,
        0x30,
        0x2e,
        0x33,
        0x67,
        0x70,
        0x70,
        0x6e,
        0x65,
        0x74,
        0x77,
        0x6f,
        0x72,
        0x6b,
        0x2e,
        0x6f,
        0x72,
        0x67,
        0x3e,
        0x3b,
        0x74,
        0x61,
        0x67,
        0x3d,
        0x64,
        0x64,
        0x65,
        0x63,
        0x62,
        0x52,
        0x4b,
        0x0d,
        0x0a,
        0x43,
        0x6f,
        0x6e,
        0x74,
        0x61,
        0x63,
        0x74,
        0x3a,
        0x20,
        0x3c,
        0x73,
        0x69,
        0x70,
        0x3a,
        0x34,
        0x36,
        0x30,
        0x30,
        0x30,
        0x38,
        0x37,
        0x36,
        0x35,
        0x34,
        0x33,
        0x32,
        0x31,
        0x30,
        0x31,
        0x40,
        0x5b,
        0x66,
        0x64,
        0x30,
        0x31,
        0x3a,
        0x33,
        0x32,
        0x30,
        0x30,
        0x3a,
        0x33,
        0x32,
        0x36,
        0x34,
        0x3a,
        0x31,
        0x3a,
        0x3a,
        0x32,
        0x5d,
        0x3a,
        0x35,
        0x30,
        0x36,
        0x30,
        0x3e,
        0x3b,
        0x2b,
        0x73,
        0x69,
        0x70,
        0x2e,
        0x69,
        0x6e,
        0x73,
        0x74,
        0x61,
        0x6e,
        0x63,
        0x65,
        0x3d,
        0x22,
        0x3c,
        0x75,
        0x72,
        0x6e,
        0x3a,
        0x67,
        0x73,
        0x6d,
        0x61,
        0x3a,
        0x69,
        0x6d,
        0x65,
        0x69,
        0x3a,
        0x38,
        0x36,
        0x35,
        0x36,
        0x36,
        0x31,
        0x30,
        0x34,
        0x2d,
        0x31,
        0x32,
        0x35,
        0x30,
        0x35,
        0x34,
        0x2d,
        0x30,
        0x3e,
        0x22,
        0x3b,
        0x2b,
        0x67,
        0x2e,
        0x33,
        0x67,
        0x70,
        0x70,
        0x2e,
        0x61,
        0x63,
        0x63,
        0x65,
        0x73,
        0x73,
        0x74,
        0x79,
        0x70,
        0x65,
        0x3d,
        0x22,
        0x63,
        0x65,
        0x6c,
        0x6c,
        0x75,
        0x6c,
        0x61,
        0x72,
        0x32,
        0x22,
        0x3b,
        0x61,
        0x75,
        0x64,
        0x69,
        0x6f,
        0x3b,
        0x76,
        0x69,
        0x64,
        0x65,
        0x6f,
        0x3b,
        0x2b,
        0x67,
        0x2e,
        0x33,
        0x67,
        0x70,
        0x70,
        0x2e,
        0x73,
        0x6d,
        0x73,
        0x69,
        0x70,
        0x3b,
        0x2b,
        0x67,
        0x2e,
        0x33,
        0x67,
        0x70,
        0x70,
        0x2e,
        0x69,
        0x63,
        0x73,
        0x69,
        0x2d,
        0x72,
        0x65,
        0x66,
        0x3d,
        0x22,
        0x75,
        0x72,
        0x6e,
        0x25,
        0x33,
        0x41,
        0x75,
        0x72,
        0x6e,
        0x2d,
        0x37,
        0x25,
        0x33,
        0x41,
        0x33,
        0x67,
        0x70,
        0x70,
        0x2d,
        0x73,
        0x65,
        0x72,
        0x76,
        0x69,
        0x63,
        0x65,
        0x2e,
        0x69,
        0x6d,
        0x73,
        0x2e,
        0x69,
        0x63,
        0x73,
        0x69,
        0x2e,
        0x6d,
        0x6d,
        0x74,
        0x65,
        0x6c,
        0x22,
        0x0d,
        0x0a,
        0x45,
        0x78,
        0x70,
        0x69,
        0x72,
        0x65,
        0x73,
        0x3a,
        0x20,
        0x36,
        0x30,
        0x30,
        0x30,
        0x30,
        0x30,
        0x0d,
        0x0a,
        0x50,
        0x2d,
        0x41,
        0x63,
        0x63,
        0x65,
        0x73,
        0x73,
        0x2d,
        0x4e,
        0x65,
        0x74,
        0x77,
        0x6f,
        0x72,
        0x6b,
        0x2d,
        0x49,
        0x6e,
        0x66,
        0x6f,
        0x3a,
        0x20,
        0x33,
        0x47,
        0x50,
        0x50,
        0x2d,
        0x45,
        0x2d,
        0x55,
        0x54,
        0x52,
        0x41,
        0x4e,
        0x2d,
        0x54,
        0x44,
        0x44,
        0x3b,
        0x75,
        0x74,
        0x72,
        0x61,
        0x6e,
        0x2d,
        0x63,
        0x65,
        0x6c,
        0x6c,
        0x2d,
        0x69,
        0x64,
        0x2d,
        0x33,
        0x67,
        0x70,
        0x70,
        0x3d,
        0x34,
        0x36,
        0x30,
        0x30,
        0x30,
        0x33,
        0x31,
        0x33,
        0x32,
        0x43,
        0x42,
        0x38,
        0x44,
        0x44,
        0x46,
        0x30,
        0x0d,
        0x0a,
        0x53,
        0x75,
        0x70,
        0x70,
        0x6f,
        0x72,
        0x74,
        0x65,
        0x64,
        0x3a,
        0x20,
        0x70,
        0x61,
        0x74,
        0x68,
        0x2c,
        0x73,
        0x65,
        0x63,
        0x2d,
        0x61,
        0x67,
        0x72,
        0x65,
        0x65,
        0x0d,
        0x0a,
        0x41,
        0x6c,
        0x6c,
        0x6f,
        0x77,
        0x3a,
        0x20,
        0x49,
        0x4e,
        0x56,
        0x49,
        0x54,
        0x45,
        0x2c,
        0x41,
        0x43,
        0x4b,
        0x2c,
        0x4f,
        0x50,
        0x54,
        0x49,
        0x4f,
        0x4e,
        0x53,
        0x2c,
        0x42,
        0x59,
        0x45,
        0x2c,
        0x43,
        0x41,
        0x4e,
        0x43,
        0x45,
        0x4c,
        0x2c,
        0x55,
        0x50,
        0x44,
        0x41,
        0x54,
        0x45,
        0x2c,
        0x50,
        0x52,
        0x41,
        0x43,
        0x4b,
        0x2c,
        0x4e,
        0x4f,
        0x54,
        0x49,
        0x46,
        0x59,
        0x2c,
        0x4d,
        0x45,
        0x53,
        0x53,
        0x41,
        0x47,
        0x45,
        0x2c,
        0x52,
        0x45,
        0x46,
        0x45,
        0x52,
        0x0d,
        0x0a,
        0x52,
        0x65,
        0x71,
        0x75,
        0x69,
        0x72,
        0x65,
        0x3a,
        0x20,
        0x73,
        0x65,
        0x63,
        0x2d,
        0x61,
        0x67,
        0x72,
        0x65,
        0x65,
        0x0d,
        0x0a,
        0x50,
        0x72,
        0x6f,
        0x78,
        0x79,
        0x2d,
        0x52,
        0x65,
        0x71,
        0x75,
        0x69,
        0x72,
        0x65,
        0x3a,
        0x20,
        0x73,
        0x65,
        0x63,
        0x2d,
        0x61,
        0x67,
        0x72,
        0x65,
        0x65,
        0x0d,
        0x0a,
        0x53,
        0x65,
        0x63,
        0x75,
        0x72,
        0x69,
        0x74,
        0x79,
        0x2d,
        0x43,
        0x6c,
        0x69,
        0x65,
        0x6e,
        0x74,
        0x3a,
        0x20,
        0x69,
        0x70,
        0x73,
        0x65,
        0x63,
        0x2d,
        0x33,
        0x67,
        0x70,
        0x70,
        0x3b,
        0x61,
        0x6c,
        0x67,
        0x3d,
        0x68,
        0x6d,
        0x61,
        0x63,
        0x2d,
        0x73,
        0x68,
        0x61,
        0x2d,
        0x31,
        0x2d,
        0x39,
        0x36,
        0x3b,
        0x70,
        0x72,
        0x6f,
        0x74,
        0x3d,
        0x65,
        0x73,
        0x70,
        0x3b,
        0x6d,
        0x6f,
        0x64,
        0x3d,
        0x74,
        0x72,
        0x61,
        0x6e,
        0x73,
        0x3b,
        0x65,
        0x61,
        0x6c,
        0x67,
        0x3d,
        0x64,
        0x65,
        0x73,
        0x2d,
        0x65,
        0x64,
        0x65,
        0x33,
        0x2d,
        0x63,
        0x62,
        0x63,
        0x3b,
        0x73,
        0x70,
        0x69,
        0x2d,
        0x63,
        0x3d,
        0x31,
        0x38,
        0x39,
        0x39,
        0x33,
        0x38,
        0x31,
        0x33,
        0x3b,
        0x73,
        0x70,
        0x69,
        0x2d,
        0x73,
        0x3d,
        0x39,
        0x38,
        0x36,
        0x34,
        0x38,
        0x31,
        0x38,
        0x32,
        0x3b,
        0x70,
        0x6f,
        0x72,
        0x74,
        0x2d,
        0x63,
        0x3d,
        0x33,
        0x31,
        0x36,
        0x31,
        0x33,
        0x3b,
        0x70,
        0x6f,
        0x72,
        0x74,
        0x2d,
        0x73,
        0x3d,
        0x33,
        0x31,
        0x39,
        0x33,
        0x37,
        0x2c,
        0x69,
        0x70,
        0x73,
        0x65,
        0x63,
        0x2d,
        0x33,
        0x67,
        0x70,
        0x70,
        0x3b,
        0x61,
        0x6c,
        0x67,
        0x3d,
        0x68,
        0x6d,
        0x61,
        0x63,
        0x2d,
        0x73,
        0x68,
        0x61,
        0x2d,
        0x31,
        0x2d,
        0x39,
        0x36,
        0x3b,
        0x70,
        0x72,
        0x6f,
        0x74,
        0x3d,
        0x65,
        0x73,
        0x70,
        0x3b,
        0x6d,
        0x6f,
        0x64,
        0x3d,
        0x74,
        0x72,
        0x61,
        0x6e,
        0x73,
        0x3b,
        0x65,
        0x61,
        0x6c,
        0x67,
        0x3d,
        0x61,
        0x65,
        0x73,
        0x2d,
        0x63,
        0x62,
        0x63,
        0x3b,
        0x73,
        0x70,
        0x69,
        0x2d,
        0x63,
        0x3d,
        0x31,
        0x38,
        0x39,
        0x39,
        0x33,
        0x38,
        0x31,
        0x33,
        0x3b,
        0x73,
        0x70,
        0x69,
        0x2d,
        0x73,
        0x3d,
        0x39,
        0x38,
        0x36,
        0x34,
        0x38,
        0x31,
        0x38,
        0x32,
        0x3b,
        0x70,
        0x6f,
        0x72,
        0x74,
        0x2d,
        0x63,
        0x3d,
        0x33,
        0x31,
        0x36,
        0x31,
        0x33,
        0x3b,
        0x70,
        0x6f,
        0x72,
        0x74,
        0x2d,
        0x73,
        0x3d,
        0x33,
        0x31,
        0x39,
        0x33,
        0x37,
        0x2c,
        0x69,
        0x70,
        0x73,
        0x65,
        0x63,
        0x2d,
        0x33,
        0x67,
        0x70,
        0x70,
        0x3b,
        0x61,
        0x6c,
        0x67,
        0x3d,
        0x68,
        0x6d,
        0x61,
        0x63,
        0x2d,
        0x6d,
        0x64,
        0x35,
        0x2d,
        0x39,
        0x36,
        0x3b,
        0x70,
        0x72,
        0x6f,
        0x74,
        0x3d,
        0x65,
        0x73,
        0x70,
        0x3b,
        0x6d,
        0x6f,
        0x64,
        0x3d,
        0x74,
        0x72,
        0x61,
        0x6e,
        0x73,
        0x3b,
        0x65,
        0x61,
        0x6c,
        0x67,
        0x3d,
        0x6e,
        0x75,
        0x6c,
        0x6c,
        0x3b,
        0x73,
        0x70,
        0x69,
        0x2d,
        0x63,
        0x3d,
        0x31,
        0x38,
        0x39,
        0x39,
        0x33,
        0x38,
        0x31,
        0x33,
        0x3b,
        0x73,
        0x70,
        0x69,
        0x2d,
        0x73,
        0x3d,
        0x39,
        0x38,
        0x36,
        0x34,
        0x38,
        0x31,
        0x38,
        0x32,
        0x3b,
        0x70,
        0x6f,
        0x72,
        0x74,
        0x2d,
        0x63,
        0x3d,
        0x33,
        0x31,
        0x36,
        0x31,
        0x33,
        0x3b,
        0x70,
        0x6f,
        0x72,
        0x74,
        0x2d,
        0x73,
        0x3d,
        0x33,
        0x31,
        0x39,
        0x33,
        0x37,
        0x0d,
        0x0a,
        0x41,
        0x75,
        0x74,
        0x68,
        0x6f,
        0x72,
        0x69,
        0x7a,
        0x61,
        0x74,
        0x69,
        0x6f,
        0x6e,
        0x3a,
        0x20,
        0x44,
        0x69,
        0x67,
        0x65,
        0x73,
        0x74,
        0x20,
        0x75,
        0x73,
        0x65,
        0x72,
        0x6e,
        0x61,
        0x6d,
        0x65,
        0x3d,
        0x22,
        0x34,
        0x36,
        0x30,
        0x30,
        0x30,
        0x38,
        0x37,
        0x36,
        0x35,
        0x34,
        0x33,
        0x32,
        0x31,
        0x30,
        0x31,
        0x40,
        0x69,
        0x6d,
        0x73,
        0x2e,
        0x6d,
        0x6e,
        0x63,
        0x30,
        0x30,
        0x30,
        0x2e,
        0x6d,
        0x63,
        0x63,
        0x34,
        0x36,
        0x30,
        0x2e,
        0x33,
        0x67,
        0x70,
        0x70,
        0x6e,
        0x65,
        0x74,
        0x77,
        0x6f,
        0x72,
        0x6b,
        0x2e,
        0x6f,
        0x72,
        0x67,
        0x22,
        0x2c,
        0x72,
        0x65,
        0x61,
        0x6c,
        0x6d,
        0x3d,
        0x22,
        0x69,
        0x6d,
        0x73,
        0x2e,
        0x6d,
        0x6e,
        0x63,
        0x30,
        0x30,
        0x30,
        0x2e,
        0x6d,
        0x63,
        0x63,
        0x34,
        0x36,
        0x30,
        0x2e,
        0x33,
        0x67,
        0x70,
        0x70,
        0x6e,
        0x65,
        0x74,
        0x77,
        0x6f,
        0x72,
        0x6b,
        0x2e,
        0x6f,
        0x72,
        0x67,
        0x22,
        0x2c,
        0x75,
        0x72,
        0x69,
        0x3d,
        0x22,
        0x73,
        0x69,
        0x70,
        0x3a,
        0x69,
        0x6d,
        0x73,
        0x2e,
        0x6d,
        0x6e,
        0x63,
        0x30,
        0x30,
        0x30,
        0x2e,
        0x6d,
        0x63,
        0x63,
        0x34,
        0x36,
        0x30,
        0x2e,
        0x33,
        0x67,
        0x70,
        0x70,
        0x6e,
        0x65,
        0x74,
        0x77,
        0x6f,
        0x72,
        0x6b,
        0x2e,
        0x6f,
        0x72,
        0x67,
        0x22,
        0x2c,
        0x6e,
        0x6f,
        0x6e,
        0x63,
        0x65,
        0x3d,
        0x22,
        0x22,
        0x2c,
        0x72,
        0x65,
        0x73,
        0x70,
        0x6f,
        0x6e,
        0x73,
        0x65,
        0x3d,
        0x22,
        0x22,
        0x0d,
        0x0a,
        0x43,
        0x61,
        0x6c,
        0x6c,
        0x2d,
        0x49,
        0x44,
        0x3a,
        0x20,
        0x63,
        0x63,
        0x65,
        0x63,
        0x62,
        0x52,
        0x4b,
        0x31,
        0x64,
        0x40,
        0x5b,
        0x66,
        0x64,
        0x30,
        0x31,
        0x3a,
        0x33,
        0x32,
        0x30,
        0x30,
        0x3a,
        0x33,
        0x32,
        0x36,
        0x34,
        0x3a,
        0x31,
        0x3a,
        0x3a,
        0x32,
        0x5d,
        0x0d,
        0x0a,
        0x43,
        0x53,
        0x65,
        0x71,
        0x3a,
        0x20,
        0x31,
        0x20,
        0x52,
        0x45,
        0x47,
        0x49,
        0x53,
        0x54,
        0x45,
        0x52,
        0x0d,
        0x0a,
        0x4d,
        0x61,
        0x78,
        0x2d,
        0x46,
        0x6f,
        0x72,
        0x77,
        0x61,
        0x72,
        0x64,
        0x73,
        0x3a,
        0x20,
        0x37,
        0x30,
        0x0d,
        0x0a,
        0x56,
        0x69,
        0x61,
        0x3a,
        0x20,
        0x53,
        0x49,
        0x50,
        0x2f,
        0x32,
        0x2e,
        0x30,
        0x2f,
        0x55,
        0x44,
        0x50,
        0x20,
        0x5b,
        0x66,
        0x64,
        0x30,
        0x31,
        0x3a,
        0x33,
        0x32,
        0x30,
        0x30,
        0x3a,
        0x33,
        0x32,
        0x36,
        0x34,
        0x3a,
        0x31,
        0x3a,
        0x3a,
        0x32,
        0x5d,
        0x3a,
        0x35,
        0x30,
        0x36,
        0x30,
        0x3b,
        0x62,
        0x72,
        0x61,
        0x6e,
        0x63,
        0x68,
        0x3d,
        0x7a,
        0x39,
        0x68,
        0x47,
        0x34,
        0x62,
        0x4b,
        0x61,
        0x65,
        0x65,
        0x63,
        0x62,
        0x52,
        0x4b,
        0x31,
        0x64,
        0x71,
        0x66,
        0x69,
        0x47,
        0x72,
        0x65,
        0x61,
        0x61,
        0x71,
        0x32,
        0x59,
        0x3b,
        0x72,
        0x70,
        0x6f,
        0x72,
        0x74,
        0x0d,
        0x0a,
        0x55,
        0x73,
        0x65,
        0x72,
        0x2d,
        0x41,
        0x67,
        0x65,
        0x6e,
        0x74,
        0x3a,
        0x20,
        0x49,
        0x4d,
        0x2d,
        0x63,
        0x6c,
        0x69,
        0x65,
        0x6e,
        0x74,
        0x2f,
        0x4f,
        0x4d,
        0x41,
        0x31,
        0x2e,
        0x30,
        0x20,
        0x48,
        0x57,
        0x2d,
        0x52,
        0x74,
        0x6f,
        0x2f,
        0x56,
        0x31,
        0x2e,
        0x30,
        0x0d,
        0x0a,
        0x43,
        0x6f,
        0x6e,
        0x74,
        0x65,
        0x6e,
        0x74,
        0x2d,
        0x4c,
        0x65,
        0x6e,
        0x67,
        0x74,
        0x68,
        0x3a,
        0x20,
        0x39,
        0x0d,
        0x0a,
        0x0d,
        0x0a,
        0x31,
        0x32,
        0x33,
        0x34,
        0x35,
        0x36,
        0x37,
        0x38,
        0x39,
    };

    printf("%s\n", hdr);
    sip_t sip;
    memset(&sip.headers, 0, sizeof(sip.headers));
    sip_settings_t settings;
    memset(&settings, 0, sizeof(sip_settings_t));
    sip.data = hdr;
    sip.len = sizeof(hdr);
    sip.settings = &settings;
    set_default_cbs(&settings);

/*
    add_hdr_cb("to", just_print_header, sip.settings);
    add_hdr_cb("from", just_print_header, sip.settings);
    add_hdr_cb("contact", just_print_header, sip.settings);
    add_hdr_cb("expires", just_print_header, sip.settings);
    add_hdr_cb("p-access-network-info", just_print_header, sip.settings);
    add_hdr_cb("supported", just_print_header, sip.settings);
    add_hdr_cb("allow", just_print_header, sip.settings);
    add_hdr_cb("require", just_print_header, sip.settings);
    add_hdr_cb("proxy-require", just_print_header, sip.settings);
    add_hdr_cb("security-client", just_print_header, sip.settings);
    add_hdr_cb("authorization", just_print_header, sip.settings);
    add_hdr_cb("call-id", just_print_header, sip.settings);
    add_hdr_cb("cseq", just_print_header, sip.settings);
    add_hdr_cb("max-forwards", just_print_header, sip.settings);
    add_hdr_cb("via", just_print_header, sip.settings);
    add_hdr_cb("user-agent", just_print_header, sip.settings);
    add_hdr_cb("content-length", assign_content_length, sip.settings);
*/

    parse(&sip);

    dump_sip(&sip);

    release_hdr_cbs(sip.settings);
}
